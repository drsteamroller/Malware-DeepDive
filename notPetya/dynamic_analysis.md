# notPetya: Dynamic Analysis

Most people probably know and have seen the splash screen that notPetya displays, but its nice to explore the effects in detail.

Upon changing the larger notPetya file from a .BIN to a .EXE, it changes its icon to its socially engineered picture:

<img title="PDF.exe??" src="images/pdfexe.png">

Windows ships its operating system with the option to see file extensions **turned off**. This is why this attack was so successful against people who left this option set to default off. It just appears as if its a pdf, and say it was sent from an email that was similar to the person's boss/superior, they might try to open it. The only thing that is suspicious is that the file asks for admin privileges. This was probably mitigated through some careful social engineering like mentioned before.

Before I run the larger file, here is what the icon changes to for the smaller file:

<img title="installer.exe??" src="images/installerexe.png">

This one looks like an installer, so this one was probably circulated more in the standard virus scene of masquerading as legitimate software.

Now I'm gonna run them both before I put them through some other dynamic tools.

A little bit after giving the pdf Petya admin privileges, the VM crashes. This is the screen I get after restarting it:

<img title="fake chdsk" src="images/fakechdsk.png">

<img title="Splash Screen" src="images/petya.png">

<img title="Hacker's Message" src="images/goodluck.png">

Running the smaller file yields the same results. I'm not completely sure, but I think that it ran faster, so I wonder if the EternalBlue exploit (how this malware typically spreads) is absent in this smaller version, but that's just conjecture.